<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRA | AI Resume Analyzer</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'neon-green': '#10b981',
                        'primary': '#3b82f6',
                        'secondary': '#8b5cf6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Custom Styles -->
    <link href="./style.css" rel="stylesheet">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <!-- Puter JS SDK -->
    <script src="https://js.puter.com/v2/"></script>

    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>

    <!-- jsPDF for Reporting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body class="min-h-screen font-sans text-gray-800 overflow-x-hidden selection:bg-emerald-500 selection:text-white bg-gray-50">

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 z-[100] bg-white/95 backdrop-blur-3xl flex items-center justify-center">
        <div class="text-center">
            <div class="w-16 h-16 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">Loading AIRA</h2>
            <p class="text-gray-600">Initializing AI Resume Analyzer...</p>
        </div>
    </div>

    <!-- Navigation -->
    <nav id="navbar" class="fixed top-0 w-full bg-white/90 backdrop-blur-md shadow-sm z-50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl md:text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-blue-600 tracking-tighter italic">
                            AIRA
                        </h1>
                    </div>
                    <div class="hidden md:block ml-10">
                        <div class="flex items-baseline space-x-4">
                            <a href="#features" class="text-gray-600 hover:text-emerald-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Features</a>
                            <a href="#how-it-works" class="text-gray-600 hover:text-emerald-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">How It Works</a>
                            <a href="#about" class="text-gray-600 hover:text-emerald-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">About</a>
                        </div>
                    </div>
                </div>

                <!-- Auth Buttons -->
                <div class="flex items-center space-x-4">
                    <button id="sign-in-btn" class="bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors">
                        <i class="fas fa-sign-in-alt mr-2"></i>Sign In
                    </button>
                    <button id="user-menu-btn" class="hidden bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors">
                        <i class="fas fa-user mr-2"></i>
                        <span id="user-name">User</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <!-- Landing Section -->
        <section id="landing-view" class="min-h-screen flex items-center justify-center px-4 pt-16">
            <div class="max-w-6xl mx-auto text-center">
                <div class="mb-8" data-animate="fade-in">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-emerald-500 to-blue-600 rounded-2xl shadow-2xl mb-6">
                        <i class="fas fa-robot text-white text-3xl"></i>
                    </div>
                    <h1 class="text-5xl md:text-7xl font-black text-gray-900 mb-6">
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-blue-600">AIRA</span>
                    </h1>
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-700 mb-4">
                        AI Resume Analyzer
                    </h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-8">
                        Transform your resume with advanced AI analysis. Get ATS optimization, detailed feedback, and personalized recommendations to land your dream job.
                    </p>
                </div>

                <div class="flex flex-col sm:flex-row gap-4 justify-center" data-animate="slide-up">
                    <button id="start-analysis-btn" class="bg-gradient-to-r from-emerald-600 to-blue-600 text-white px-8 py-4 rounded-xl font-bold text-lg hover:from-emerald-700 hover:to-blue-700 transition-all transform hover:scale-105 shadow-xl">
                        <i class="fas fa-search mr-2"></i>
                        Start Analysis
                    </button>
                    <button id="learn-more-btn" class="bg-white text-gray-700 px-8 py-4 rounded-xl font-bold text-lg border-2 border-gray-200 hover:border-emerald-500 hover:text-emerald-600 transition-all transform hover:scale-105 shadow-xl">
                        <i class="fas fa-info-circle mr-2"></i>
                        Learn More
                    </button>
                </div>

                <!-- Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-16" data-animate="fade-in">
                    <div class="text-center">
                        <div class="text-4xl font-bold text-emerald-600 mb-2">95%</div>
                        <div class="text-gray-600">ATS Compatibility Rate</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl font-bold text-blue-600 mb-2">50K+</div>
                        <div class="text-gray-600">Resumes Analyzed</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl font-bold text-purple-600 mb-2">3x</div>
                        <div class="text-gray-600">Interview Rate Increase</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard-view" class="min-h-screen hidden px-4 pt-24 pb-12">
            <div class="max-w-7xl mx-auto">
                <!-- Upload Section -->
                <div class="text-center mb-12" data-animate="fade-in">
                    <h2 class="text-4xl font-bold text-gray-900 mb-4">Upload Your Resume</h2>
                    <p class="text-xl text-gray-600">Get instant AI-powered analysis and ATS optimization</p>
                </div>

                <div class="max-w-4xl mx-auto mb-12">
                    <div id="upload-area" class="glass-card rounded-2xl p-12 text-center border-2 border-dashed border-gray-300 hover:border-emerald-500 transition-all cursor-pointer transform hover:scale-[1.02]">
                        <div class="mb-6">
                            <i class="fas fa-cloud-upload-alt text-6xl text-gray-400"></i>
                        </div>
                        <h3 class="text-2xl font-semibold text-gray-700 mb-4">
                            Drop your resume here
                        </h3>
                        <p class="text-gray-500 mb-6">
                            Supports PDF, DOC, DOCX files (Max 10MB)
                        </p>
                        <input type="file" id="resume-file" class="hidden" accept=".pdf,.doc,.docx">
                        <button id="browse-files-btn" class="bg-emerald-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-emerald-700 transition-colors">
                            <i class="fas fa-folder-open mr-2"></i>
                            Browse Files
                        </button>
                    </div>

                    <div class="text-center mt-6">
                        <button id="analyze-btn" disabled class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg font-semibold opacity-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fas fa-brain mr-2"></i>
                            Analyze with AI
                        </button>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="results-section" class="hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
                        <!-- Score Card -->
                        <div class="lg:col-span-1">
                            <div class="glass-card rounded-2xl p-8 bg-white shadow-xl border border-gray-100">
                                <h3 class="text-xl font-bold text-gray-900 mb-6">ATS Score</h3>
                                <div class="relative w-48 h-48 mx-auto mb-6">
                                    <svg class="w-48 h-48 transform -rotate-90">
                                        <circle cx="96" cy="96" r="88" stroke="#e5e7eb" stroke-width="12" fill="none"/>
                                        <circle id="score-ring" cx="96" cy="96" r="88" stroke="url(#gradient)" stroke-width="12" fill="none"
                                                stroke-dasharray="553" stroke-dashoffset="553" stroke-linecap="round"/>
                                        <defs>
                                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                                <stop offset="0%" stop-color="#10b981"/>
                                                <stop offset="100%" stop-color="#3b82f6"/>
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <div class="text-center">
                                            <div id="ats-score" class="text-4xl font-black text-gray-900">0</div>
                                            <div class="text-sm text-gray-500">Total Score</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Export PDF Button -->
                                <button id="export-pdf-btn" class="w-full py-3 bg-gray-900 text-white rounded-xl font-semibold hover:bg-black transition-all active:scale-95">
                                    <i class="fas fa-download mr-2"></i>
                                    Export PDF Report
                                </button>

                                <!-- Category Summary -->
                                <div id="category-summary" class="mt-6 space-y-3">
                                    <!-- Categories will be inserted here -->
                                </div>
                            </div>
                        </div>

                        <!-- Main Findings -->
                        <div class="lg:col-span-2">
                            <div class="space-y-6" id="feedback-list">
                                <!-- Feedback cards will be inserted here -->
                            </div>

                            <!-- AI Chat Assistant -->
                            <div id="chat-assistant" class="glass-card mt-8 rounded-2xl bg-white shadow-xl border border-gray-100 overflow-hidden opacity-0 pointer-events-none translate-y-10 transition-all duration-500">
                                <div class="p-6 border-b border-gray-100 flex items-center justify-between bg-emerald-50">
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 bg-emerald-600 rounded-xl flex items-center justify-center text-white">
                                            <i class="fas fa-comments"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-gray-900">AI Career Strategist</h3>
                                            <p class="text-xs text-emerald-600 font-semibold uppercase tracking-wider">Interactive Assistant</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span>
                                        <span class="text-xs text-gray-500 font-semibold uppercase tracking-wider">Online</span>
                                    </div>
                                </div>

                                <!-- Chat Messages -->
                                <div id="chat-messages" class="h-96 overflow-y-auto p-6 space-y-4">
                                    <div class="flex justify-start">
                                        <div class="max-w-[80%] p-4 bg-gray-50 rounded-2xl rounded-tl-none">
                                            <p class="text-sm text-gray-700">
                                                Hello! I've analyzed your resume. I can help you improve specific sections, suggest better keywords, or provide career advice. What would you like to work on?
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Chat Input -->
                                <div class="p-4 border-t border-gray-100">
                                    <div class="flex gap-3">
                                        <input type="text" id="chat-input" class="flex-1 px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent outline-none" placeholder="Ask for resume advice...">
                                        <button id="chat-send-btn" class="px-4 py-3 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 transition-colors">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="py-20 px-4 bg-gray-100">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-bold text-gray-900 mb-4">Powerful Features</h2>
                    <p class="text-xl text-gray-600">Everything you need to optimize your resume</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="glass-card p-8 rounded-2xl bg-white shadow-xl" data-animate="scale-in">
                        <div class="w-16 h-16 bg-emerald-100 rounded-xl flex items-center justify-center mb-6">
                            <i class="fas fa-brain text-emerald-600 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">AI-Powered Analysis</h3>
                        <p class="text-gray-600">Advanced machine learning algorithms analyze your resume against real ATS systems</p>
                    </div>

                    <div class="glass-card p-8 rounded-2xl bg-white shadow-xl" data-animate="scale-in">
                        <div class="w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center mb-6">
                            <i class="fas fa-chart-line text-blue-600 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Deterministic Scoring</h3>
                        <p class="text-gray-600">Get precise, reproducible scores with detailed breakdowns across multiple dimensions</p>
                    </div>

                    <div class="glass-card p-8 rounded-2xl bg-white shadow-xl" data-animate="scale-in">
                        <div class="w-16 h-16 bg-purple-100 rounded-xl flex items-center justify-center mb-6">
                            <i class="fas fa-comments text-purple-600 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">AI Career Strategist</h3>
                        <p class="text-gray-600">Interactive chat assistant provides personalized advice and improvement suggestions</p>
                    </div>

                    <div class="glass-card p-8 rounded-2xl bg-white shadow-xl" data-animate="scale-in">
                        <div class="w-16 h-16 bg-red-100 rounded-xl flex items-center justify-center mb-6">
                            <i class="fas fa-file-pdf text-red-600 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">PDF Reports</h3>
                        <p class="text-gray-600">Download comprehensive analysis reports in professional PDF format</p>
                    </div>

                    <div class="glass-card p-8 rounded-2xl bg-white shadow-xl" data-animate="scale-in">
                        <div class="w-16 h-16 bg-yellow-100 rounded-xl flex items-center justify-center mb-6">
                            <i class="fas fa-lock text-yellow-600 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Privacy First</h3>
                        <p class="text-gray-600">All processing happens securely in your browser with encrypted cloud storage</p>
                    </div>

                    <div class="glass-card p-8 rounded-2xl bg-white shadow-xl" data-animate="scale-in">
                        <div class="w-16 h-16 bg-indigo-100 rounded-xl flex items-center justify-center mb-6">
                            <i class="fas fa-bolt text-indigo-600 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Instant Results</h3>
                        <p class="text-gray-600">Get comprehensive analysis and recommendations in seconds, not minutes</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works -->
        <section id="how-it-works" class="py-20 px-4">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-bold text-gray-900 mb-4">How It Works</h2>
                    <p class="text-xl text-gray-600">Simple steps to optimize your resume</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                    <div class="text-center" data-animate="slide-up">
                        <div class="w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-2xl font-bold text-emerald-600">1</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Upload Resume</h3>
                        <p class="text-gray-600">Upload your resume in PDF, DOC, or DOCX format</p>
                    </div>

                    <div class="text-center" data-animate="slide-up">
                        <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-2xl font-bold text-blue-600">2</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">AI Analysis</h3>
                        <p class="text-gray-600">Our AI analyzes your resume against ATS systems</p>
                    </div>

                    <div class="text-center" data-animate="slide-up">
                        <div class="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-2xl font-bold text-purple-600">3</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Get Feedback</h3>
                        <p class="text-gray-600">Receive detailed feedback and improvement suggestions</p>
                    </div>

                    <div class="text-center" data-animate="slide-up">
                        <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-2xl font-bold text-red-600">4</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Optimize & Apply</h3>
                        <p class="text-gray-600">Apply improvements and increase your interview chances</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-20 px-4 bg-gray-100">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-4xl font-bold text-gray-900 mb-8">About AIRA</h2>
                <p class="text-xl text-gray-600 mb-8">
                    AIRA (AI Resume Analyzer) is an intelligent platform designed to bridge the gap between job seekers and Applicant Tracking Systems. 
                    Using advanced AI technology, we provide comprehensive resume analysis that helps candidates optimize their applications and increase their chances of landing interviews.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                    <div>
                        <div class="text-3xl font-bold text-emerald-600 mb-2">University Students</div>
                        <div class="text-gray-600">Perfect for entry-level positions and internships</div>
                    </div>
                    <div>
                        <div class="text-3xl font-bold text-blue-600 mb-2">Recent Graduates</div>
                        <div class="text-gray-600">Optimize your resume for your first professional role</div>
                    </div>
                    <div>
                        <div class="text-3xl font-bold text-purple-600 mb-2">Career Changers</div>
                        <div class="text-gray-600">Highlight transferable skills effectively</div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="flex items-center justify-center gap-3 mb-6">
                <div class="w-12 h-12 bg-emerald-600 rounded-xl flex items-center justify-center">
                    <i class="fas fa-robot text-white text-xl"></i>
                </div>
                <h3 class="text-2xl font-black">AIRA</h3>
            </div>
            <p class="text-gray-400 mb-6">AI Resume Analyzer - Transform your career with intelligent resume optimization</p>
            <div class="flex justify-center gap-6 mb-8">
                <a href="#" class="text-gray-400 hover:text-emerald-500 transition-colors">
                    <i class="fab fa-twitter text-xl"></i>
                </a>
                <a href="#" class="text-gray-400 hover:text-emerald-500 transition-colors">
                    <i class="fab fa-linkedin text-xl"></i>
                </a>
                <a href="#" class="text-gray-400 hover:text-emerald-500 transition-colors">
                    <i class="fab fa-github text-xl"></i>
                </a>
            </div>
            <p class="text-gray-500 text-sm">Â© 2024 AIRA. All rights reserved. Powered by Puter AI</p>
        </div>
    </footer>

    <!-- Analysis Loading Overlay -->
    <div id="analysis-overlay" class="fixed inset-0 z-[100] bg-white/95 backdrop-blur-3xl flex items-center justify-center hidden">
        <div class="max-w-lg w-full p-8 glass-card rounded-3xl border border-emerald-100 shadow-xl bg-white">
            <h2 class="text-3xl font-bold text-center mb-8 text-gray-900">Analyzing Resume</h2>
            
            <div class="space-y-6">
                <div class="analysis-step flex items-center gap-4">
                    <div class="step-indicator w-8 h-8 rounded-full border-2 border-emerald-500 flex items-center justify-center">
                        <i class="fas fa-check text-emerald-600 text-sm"></i>
                    </div>
                    <span class="text-gray-700 font-medium">Parsing document</span>
                </div>
                
                <div class="analysis-step flex items-center gap-4 opacity-50">
                    <div class="step-indicator w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center">
                        <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                    </div>
                    <span class="text-gray-500">Analyzing content</span>
                </div>
                
                <div class="analysis-step flex items-center gap-4 opacity-50">
                    <div class="step-indicator w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center">
                        <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                    </div>
                    <span class="text-gray-500">Generating insights</span>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Modules -->
    <script src="./js/animations.js"></script>
    <script src="./js/auth.js"></script>
    <script src="./js/logic.js"></script>
    <script src="./js/parser.js"></script>
    <script src="./js/tilt.js"></script>
    <script src="./js/validator.js"></script>
    <script src="./js/visuals.js"></script>
    <script src="./lib/puter-service.js"></script>

    <!-- Main Application -->
    <script type="module">
        import { animations } from './js/animations.js';
        import { auth } from './js/auth.js';
        import { logic } from './js/logic.js';
        import { parser } from './js/parser.js';
        import { validator } from './js/validator.js';
        import { visuals } from './js/visuals.js';
        import { puterService } from './lib/puter-service.js';

        // Initialize application
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Initialize services
                await puterService.init();
                auth.init();
                
                // Setup event listeners
                setupEventListeners();
                
                // Start animations
                animations.observeElements();
                
                // Hide loading overlay
                setTimeout(() => {
                    document.getElementById('loading-overlay').classList.add('hidden');
                }, 1500);
                
            } catch (error) {
                console.error('Application initialization failed:', error);
                showError('Failed to initialize application. Please refresh the page.');
            }
        });

        function setupEventListeners() {
            // Navigation
            document.getElementById('sign-in-btn')?.addEventListener('click', () => auth.signIn());
            document.getElementById('user-menu-btn')?.addEventListener('click', () => auth.showUserMenu());
            
            // Main actions
            document.getElementById('start-analysis-btn')?.addEventListener('click', () => showDashboard());
            document.getElementById('learn-more-btn')?.addEventListener('click', () => scrollToSection('features'));
            
            // File upload
            const uploadArea = document.getElementById('upload-area');
            const fileInput = document.getElementById('resume-file');
            const browseBtn = document.getElementById('browse-files-btn');
            const analyzeBtn = document.getElementById('analyze-btn');
            
            uploadArea?.addEventListener('click', () => fileInput?.click());
            browseBtn?.addEventListener('click', () => fileInput?.click());
            fileInput?.addEventListener('change', handleFileUpload);
            analyzeBtn?.addEventListener('click', analyzeResume);
            
            // Drag and drop
            uploadArea?.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('border-emerald-500', 'bg-emerald-50');
            });
            
            uploadArea?.addEventListener('dragleave', () => {
                uploadArea.classList.remove('border-emerald-500', 'bg-emerald-50');
            });
            
            uploadArea?.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('border-emerald-500', 'bg-emerald-50');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload({ target: { files } });
                }
            });
            
            // Chat functionality
            const chatInput = document.getElementById('chat-input');
            const chatSendBtn = document.getElementById('chat-send-btn');
            
            chatSendBtn?.addEventListener('click', sendChatMessage);
            chatInput?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendChatMessage();
            });
            
            // Export PDF
            document.getElementById('export-pdf-btn')?.addEventListener('click', () => logic.exportPDF());
        }

        function showDashboard() {
            if (!auth.isSignedIn()) {
                auth.signIn();
                return;
            }
            
            document.getElementById('landing-view').classList.add('hidden');
            document.getElementById('dashboard-view').classList.remove('hidden');
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const validation = validator.validateFile(file);
            if (!validation.valid) {
                visuals.showNotification(validation.error, 'error');
                return;
            }
            
            // Update UI
            document.getElementById('analyze-btn').disabled = false;
            document.getElementById('analyze-btn').classList.remove('opacity-50');
            visuals.showNotification(`File uploaded: ${file.name}`, 'success');
        }

        async function analyzeResume() {
            const fileInput = document.getElementById('resume-file');
            const file = fileInput?.files[0];
            
            if (!file) {
                visuals.showNotification('Please upload a resume first', 'error');
                return;
            }
            
            try {
                await logic.analyzeResume(file);
            } catch (error) {
                visuals.showNotification('Analysis failed. Please try again.', 'error');
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addChatMessage(message, 'user');
            input.value = '';
            
            // Get AI response
            logic.getChatResponse(message).then(response => {
                addChatMessage(response, 'assistant');
            });
        }

        function addChatMessage(message, sender) {
            const messagesContainer = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            
            if (sender === 'user') {
                messageDiv.className = 'flex justify-end';
                messageDiv.innerHTML = `
                    <div class="max-w-[80%] p-4 bg-emerald-600 text-white rounded-2xl rounded-tr-none">
                        <p class="text-sm">${message}</p>
                    </div>
                `;
            } else {
                messageDiv.className = 'flex justify-start';
                messageDiv.innerHTML = `
                    <div class="max-w-[80%] p-4 bg-gray-50 rounded-2xl rounded-tl-none">
                        <p class="text-sm text-gray-700">${message}</p>
                    </div>
                `;
            }
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function scrollToSection(sectionId) {
            document.getElementById(sectionId)?.scrollIntoView({ behavior: 'smooth' });
        }

        function showError(message) {
            visuals.showNotification(message, 'error');
        }
    </script>
</body>
</html>
